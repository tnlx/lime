{{ define "main" }}
<ul class="cardboard">
	{{ with site.Params.profile }}
	<li class="card profile">
		{{ block "profile" . }} {{ end }}
	</li>
	{{ end }}
	{{ $footerUrls := slice }}
	{{ range site.Params.footerLinks }}
	{{ $footerUrls = $footerUrls | append  .url }}
	{{ end }}
	{{ range ( where .RegularPagesRecursive "RelPermalink" "not in" $footerUrls ) }}
	<li class=card>
		<div class="carddesc">
			<ul class=categories>
				{{ range .Params.Categories }}
				<li>{{ ( or (i18n .) (title .) ) }}</li>
				{{ end }}
			</ul>
		</div>
		<div class="heading">
			<a href="{{ .RelPermalink }}">{{ .Title }}</a>
		</div>
		<div class="carddesc">
			{{ if gt .WordCount 30 }}{{/*Extract the first paragraph*/}}
			{{ partial "excerpt.html" . }}
			<a class=more href="{{ .RelPermalink }}">Read</a>
			{{ else }}{{/* Display complete contents for short pages*/}}
			{{ .Content }}
			{{ end }}
		</div>
	</li>
	{{ end }}
</ul>
{{ end }}

{{ define "profile" }}
<div class="carddesc">
	<div style="float:right;max-width:200px;text-align: right;margin:0 20px 0 0">
		{{- .Intro | markdownify -}}
	</div>
	<div class="inbox" style="float:left">
	<a class="icon" aria-label="mailbox" href="{{ .InboxURL }}">
		{{- with resources.Get "svg/mailbox.svg" -}}
		{{ .Content | safeHTML }}
		{{ end }}
		{{- with resources.Get "svg/inbox-balloon.svg" -}}
		{{ .Content | safeHTML }}
		{{ end }}
</a>
	</div>
</div>
<div class="carddesc">
	<p><em>or find me on</em></p>
	<ul class="contacts" style='display:inline'>
		{{- range .socials -}}
		<li class="contact">
			<a class="icon" aria-label="{{ .label }}" href="https://{{- .url -}}" rel="me">
				{{ $icon := ( printf "svg/%s.svg" ( .label | lower ) ) }}
				{{- with resources.Get $icon -}}
				{{ .Content | safeHTML }}
				{{ else }}
				{{- .label -}}
				{{ end }}</a>
		</li>
		{{- end -}}
	</ul>
</div>
{{ end }}
